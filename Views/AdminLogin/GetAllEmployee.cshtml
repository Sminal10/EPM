
@{
    ViewData["Title"] = "GetAllEmployee";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<h2 class="text-center">Employee List</h2>
<br />

<div id="showData" class="mt-5">
    <input type="hidden" value="0" id="hdnId" />
    <table class="table table-striped table-responsive-md" id="tblemp">
        <thead id="thead">
            <tr>
                <th>Id</th>
                <th>Emp Id</th>
                <th>FirstName</th>
                <th>MiddleName</th>
                <th>LastName</th>
                <th>Birthday</th>
                <th>Gender</th>
                <th>Mobile Number</th>
                <th>Alternate Number</th>
                <th>Address</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>
</div>


<div id="dvupEmployee" style="margin-top:30px;" hidden>
    <div class="row">
        @* First Name *@
        <div class="col-md-4">
            <label for="txtFname" id="lblFname" style="text-align:center"><i class="fa fa-user"></i>  First Name</label>
            <input type="text" class="form-control" placeholder="Enter First Name" id="txtFname" />
        </div>

        @* Middle Name *@
        <div class="col-md-4">
            <label for="txtMname" id="lblMname"><i class="fa fa-user"></i> Middle Name</label>
            <input type="text" class="form-control" placeholder="Enter Middle Name" id="txtMname" />
        </div>

        @* Last Name *@
        <div class="col-md-4">
            <label for="txtLname" id="lblLname"> <i class="fa fa-user"></i> Last Name</label>
            <input type="text" class="form-control" placeholder="Enter Last Name" id="txtLname" />
        </div>
    </div>
    <div class="row">
        @* BirthDate *@
        <div class="col-md-4">
            <label for="txtDob" id="lblDate"><i class="fa fa-birthday-cake"></i> Date Of Birth</label>
            <input type="date" class="form-control" id="txtDob" placeholder="1999-07-10">
        </div>

        @*Gender*@
        <div class="col-md-4">
            <label for="ddlGndr" id="lblGender">Gender</label>
            <select class="form-control" id="ddlgndr">
                <option selected value="0">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="others">Others</option>
            </select>
        </div>

        @*Marital Status*@
        <div class="col-md-4">
            <label for="ddlMS" id="lblStatus">Marital Status</label>
            <select class="form-control" id="ddlMS">
                <option selected value="0">Select Martital Status</option>
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </select>
        </div>
    </div>
    <div class="row">
        @* Phone Number *@
        <div class="col-md-4">
            <label for="txtPhonenum" id="lblPhonenum">Primary Phone Number</label>
            <input type="text" class="form-control" name="txtPhonenum" id="txtPhonenum" maxlength="10" placeholder="1234567890" />
        </div>

        @* Alternate Number *@
        <div class="col-md-4">
            <label for="txtAltnum" id="lblmobile">Alternate Phone Number</label>
            <input type="text" class="form-control" name="txtAltnum" id="txtAltnum" maxlength="10" placeholder="1234567890" />
        </div>

        @* Address Box *@
        <div class="col-md-4">
            <label for="txtAdd">Address</label>
            <textarea class="form-control" id="txtAdd" rows="2" placeholder="Enter Address"></textarea>
        </div>
    </div>
    <div class="row">
        @* State Name *@
        <div class="col-md-4">
            <label for="ddlState" id="lblState">State</label>
            <select class="form-control" name="state" id="ddlState">
                <option selected value="0">Select State</option>
                <option value="Andhra Pradesh">Andhra Pradesh</option>
                <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                <option value="Assam">Assam</option>
                <option value="Bihar">Bihar</option>
                <option value="Chandigarh">Chandigarh</option>
                <option value="Chhattisgarh">Chhattisgarh</option>
                <option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
                <option value="Daman and Diu">Daman and Diu</option>
                <option value="Delhi">Delhi</option>
                <option value="Lakshadweep">Lakshadweep</option>
                <option value="Puducherry">Puducherry</option>
                <option value="Goa">Goa</option>
                <option value="Gujarat">Gujarat</option>
                <option value="Haryana">Haryana</option>
                <option value="Himachal Pradesh">Himachal Pradesh</option>
                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                <option value="Jharkhand">Jharkhand</option>
                <option value="Karnataka">Karnataka</option>
                <option value="Kerala">Kerala</option>
                <option value="Madhya Pradesh">Madhya Pradesh</option>
                <option value="Maharashtra">Maharashtra</option>
                <option value="Manipur">Manipur</option>
                <option value="Meghalaya">Meghalaya</option>
                <option value="Mizoram">Mizoram</option>
                <option value="Nagaland">Nagaland</option>
                <option value="Odisha">Odisha</option>
                <option value="Punjab">Punjab</option>
                <option value="Rajasthan">Rajasthan</option>
                <option value="Sikkim">Sikkim</option>
                <option value="Tamil Nadu">Tamil Nadu</option>
                <option value="Telangana">Telangana</option>
                <option value="Tripura">Tripura</option>
                <option value="Uttar Pradesh">Uttar Pradesh</option>
                <option value="Uttarakhand">Uttarakhand</option>
                <option value="West Bengal">West Bengal</option>
            </select>
        </div>

        @* City Name *@
        <div class="col-md-4">
            <label for="txtCityname" id="lblCityname">City Name</label>
            <input type="text" class="form-control" name="txtCity" id="txtCity" />
        </div>

        @* Pincode *@
        <div class="col-md-4">
            <label for="txtPincode" id="lblPincode">Pincode</label>
            <input type="text" class="form-control" name="txtPincode" id="txtPincode" maxlength="10" placeholder="1234" />
        </div>
    </div>
    <div class="row">
        @* Salary *@
        <div class="col-md-4">
            <label for="txtSalary" id="lblSalary">Salary</label>
            <input type="text" class="form-control" name="txtSalary" id="txtSalary" placeholder="Enter Salary" />
        </div>

        @* Date of Joining *@
        <div class="col-md-4">
            <label for="txtDoj" id="lblDoj">Date Of Joining</label>
            <input type="date" class="form-control" id="txtDoj">
        </div>

        @*Qualification*@
        <div class="col-md-4">
            <label for="ddlQf" id="lblQf">Qualification</label>
            <select class="form-control" id="ddlQf">
                <option selected value="0">Select Qualification</option>
                <option value="10th">10th</option>
                <option value="12th">12th</option>
                <option value="Diploma">Diploma</option>
                <option value="Gradutaion">Graduation</option>
                <option value="PostGradutaion">Post Graduation</option>
            </select>
        </div>
    </div>
    <div class="row">

        @* Email id / Username *@
        <div class="col-md-6">
            <label for="txtEmailid" id="lblEmailid" title="This will be your username">Email Id <i class="fa fa-question-circle" title="This will be your username"></i></label>
            <input type="email" class="form-control" name="txtEmailid" id="txtEmailid" placeholder="Enter Email id" title="This will be your username" />
        </div>

        @* Password *@
        <div class="col-md-6">
            <label for="txtPass" id="lblPass" title="Enter Login Password">Password <i class="fa fa-question-circle" title="Enter Login Password"></i></label>
            <input type="password" class="form-control" name="txtPass" id="txtPass" placeholder="Enter Password" title="Enter Login Password" />
        </div>
    </div>
    <div class="row text-center" style="padding-block-start:7px">
        <input type="button" value="Update" class="btn btn-primary" id="btnUpdate" onclick="Update()" />
        <input type="button" value="Cancel" class="btn btn-danger" id="btnReset" />
    </div>
</div>

<script>

    $(document).ready(function () {

        showData();
    })


    function showData() {
        $("#tbody").html('');
        var strdata = '';
        jQuery.support.cors = true;
        $.ajax({
            url: '/api/Emp/GetAllEmp',
            type: 'GET',
            contentType: 'application/json',
            success: function (data) {
                var sr = 0;
                $.each(data, function (key, item) {
                    sr += 1;
                    //var date = new Date(item.bdate);
                    //var newdate = date.getDay()+1 + '/' + date.getMonth() + '/' + date.getFullYear();
                    strdata = "<tr>" +
                        "<td>" + sr + "</td>" +
                        "<td>" + item.empid + "</td>" +
                        "<td>" + item.fname + "</td>" +
                        "<td>" + item.mname + "</td>" +
                        "<td>" + item.lname + "</td>" +
                        "<td>" + item.bdate + "</td>" +
                        "<td>" + item.gender + "</td>" +
                        "<td>" + item.mobilenum + "</td>" +
                        "<td>" + item.altnum + "</td>" +
                        "<td>" + item.address + "</td>" +
                        "<td style='width:70px;text-align: center;'><a href='#' Title='Edit' id='lnEdit' onclick='Edit(" + item.id + ")'>Edit</a> <a href='#' Title='Delete' id='lnDelete' onclick='Delete(" + item.id + ")'>Delete</a></td>"
                    $("#tbody").append(strdata);
                });

            },

            error: function (jqXHR, textStatus, err) {
                alert(err);
            }
        })
    }

    function Edit(Id) {
        divshow();
        //$("#txtarea").val('');
        //$("#hdnId").val("0");
        jQuery.support.cors = true;
        $.ajax(
            {
                url: '/api/Emp/GetEmpupdt?Id=' + Id,
                type: 'GET',
                contentType: "application/json",
                success: function (data) {
                    $("#txtFname").val(data[0].fname);
                    $("#txtMname").val(data[0].mname);
                    $("#txtLname").val(data[0].lname),
                        $("#txtDob").val(data[0].bdate),
                        $("#ddlgndr").val(data[0].gender),
                        $("#ddlMS").val(data[0].maritalStatus),
                        $("#txtPhonenum").val(data[0].mobilenum),
                        $("#txtAltnum").val(data[0].altnum),
                        $("#txtAdd").val(data[0].address),
                        $("#ddlState").val(data[0].state),
                        $("#txtCity").val(data[0].city),
                        $("#txtPincode").val(data[0].pincode),
                        $("#txtSalary").val(data[0].salary),
                        $("#txtDoj").val(data[0].startdate),
                        $("#ddlQf").val(data[0].qualification),
                        $("#txtEmailid").val(data[0].emailid),
                        $("#txtPass").val(data[0].password)

                },
                complete: function () {


                },
                error: function (jqXHR, textStatus, err) {
                    //alert(err);
                }
            });
    }

    function Update() {
        var Id = $("#hdnId").val();
        var Emp = {
            Id: id,
            Fname: $("#txtFname").val(),
            Mname: $("#txtMname").val(),
            Lname: $("#txtLname").val(),
            Bdate: $("#txtDob").val(),
            Gender: $("#ddlgndr").val(),
            MaritalStatus: $("#ddlMS").val(),
            Mobilenum: $("#txtPhonenum").val(),
            Altnum: $("#txtAltnum").val(),
            Address: $("#txtAdd").val(),
            State: $("#ddlState").val(),
            City: $("#txtCity").val(),
            Pincode: $("#txtPincode").val(),
            Salary: $("#txtSalary").val(),
            Startdate: $("#txtDoj").val(),
            Qualification: $("#ddlQf").val(),
            Emailid: $("#txtEmailid").val(),
            Password: $("#txtPass").val()
          
        }

        var ajaxRequest = $.ajax({
            url: '/api/Emp/update/'+Id,
            type: 'PUT',
            data: JSON.stringify(Emp),
            contentType: "application/json",
            success: function (data) {
                alert(0);
                //alert(data);
                location.reload();
                SuccessMsg(data);                          
               
            },
            error: function (jqXHR, textStatus, err) {
                alert(err);
            }
        });
      //  $('#btnAdd').attr('disabled', false);
    }


    function divshow() {
        $("#dvupEmployee").show();
        $("#showData").hide();

    }

    // Cancel
    $("#btnReset").click(function () {
        window.location.reload();
    });

    function Delete(Id) {
        var check = confirm("Are you sure to Delete it?")
        if (check) {

            var ajaxRequest = $.ajax({

                url: '/api/Emp/Delete?id=' + Id,

                type: 'Delete',
                data: JSON,
                contentType: "application/json",
                success: function (data) {
                    location.reload();
                    AlertMsg(data);

                },
                error: function (jqXHR, textStatus, err) {
                    //alert(err);
                }
            });
            alert('Deleted Succesfully..');
        }
    }

</script>

